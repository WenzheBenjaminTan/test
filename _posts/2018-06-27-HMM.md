---
layout: post
title: "隐马尔可夫模型" 
---

# 1、模型定义

隐马尔可夫模型（Hidden Markov Model, HMM）是结构最简单的动态贝叶斯网（dynamic Bayesian network），这是一种著名的生成式概率有向图模型，主要用于时序数据建模，在语音识别、自然语言处理等领域有广泛应用。

隐马尔可夫模型中的变量可分为两组：第一组是状态变量$$\{y_1,y_2,...,y_n\}$$，其中$$y_i$$属于$\mathcal{Y}$表示第$i$时刻的系统状态。通常假定状态变量是隐藏的、不可被观测的，因此状态变量亦称隐变量（hidden variable）；第二组是观测变量$$\{x_1,x_2,...,x_n\}$$，其中$$x_i$$属于$\mathcal{X}$表示第$i$时刻的观测值。

在隐马尔可夫模型中，系统通常在多个状态$$\{s_1,s_2,...,s_N\}$$之间转换（可以认为是事件驱动的），因此状态变量$$y_i$$的取值范围$\mathcal{Y}$（称为状态空间）通常是有$N$个可能取值的离散空间。观测变量$$x_i$$可以是离散的也可以是连续的，为了便于讨论，我们仅考虑离散型观测变量，边假定其取值范围$\mathcal{X}$为$$\{o_1,o_2,...,o_M\}$$，即有$M$个可能取值的离散空间。

在任一时刻，观测变量的取值仅依赖于状态变量，即$$x_t$$仅由$$y_t$$确定。同时，系统是一条“马尔可夫链”（Markov chain），即$t$时刻的状态$$y_t$$仅依赖于$t-1$时刻的状态$$y_{t-1}$$，与此前的状态无关。基于这种依赖关系，所有变量的联合概率分布为：

$$\begin{equation}p(x_1,y_1,...,x_n,y_n) = p(y_1)p(x_1\mid y_1)\prod_{i=2}^n p(y_i\mid y_{i-1})p(x_i\mid y_i)\label{1}\end{equation}$$

确定一个隐马尔可夫模型需要以下三组参数：

1) 状态转移概率：模型在各个状态之间转换的概率，通常记为矩阵$$\boldsymbol{A} = [a_{ij}]_{N\times N}$$，其中

$$a_{ij} = p(y_{t+1} = s_j \mid y_t = s_i), 1\leq i,j \leq N$$

2）观测概率：模型根据当前状态获得各个观测值的概率，通常记为矩阵$$\boldsymbol{B} = [b_{ij}]_{N\times M}$$，其中

$$b_{ij} = p(x_{t} = o_j \mid y_t = s_i), 1\leq i\leq N, 1\leq j\leq M$$

3）初始状态概率：模型在初始时刻各状态出现的概率，通常记为向量$$\boldsymbol{\pi} = (\pi_1,pi_2,...,\pi_N)^T$$，其中

$$\pi_{i} = p(y_{1} = s_i), 1\leq i \leq N$$

以上假设了状态转移概率和观测概率的时齐性，即与时刻$t$无关。

# 2、关于HMM的三个基本问题

HMM有以下三个基本问题：

1）估计概率分布：给定模型$$\lambda = \{\boldsymbol{A},\boldsymbol{B},\boldsymbol{\pi}\}$$，如何计算其产生观测序列$$\boldsymbol{x} = \{x_1,x_2,...,x_n\}$$的概率$$p(\boldsymbol{x}\mid \lambda)$$？

2）寻找状态序列：给定模型$$\lambda = \{\boldsymbol{A},\boldsymbol{B},\boldsymbol{\pi}\}$$和观测序列$$\boldsymbol{x} = \{x_1,x_2,...,x_n\}$$，如何找到于此观测序列最匹配的状态序列$$\boldsymbol{y} = \{y_1,y_2,...,y_n\}$$？

3）学习模型参数：给定观测序列$$\boldsymbol{x} = \{x_1,x_2,...,x_n\}$$，如何调整模型参数$$\lambda = \{\boldsymbol{A},\boldsymbol{B},\boldsymbol{\pi}\}$$使得该序列出现的概率$$p(\boldsymbol{x}\mid \lambda)$$最大？

上述问题在现实应用中非常重要。例如许多任务需根据以往的观测序列$$\{x_1,x_2,...,x_{n-1}\}$$来推测当前时刻最有可能的观测值$$x_n$$，这显然可以转化为求取概率$$p(\boldsymbol{x}\mid \lambda)$$，即上述第一个问题；在语音识别等任务中，观测值为语音信号，隐藏状态为文字，目标就是根据观测信号来推断最有可能的状态序列（即对应的文字），即上述第二个问题；在大多数现实应用中，人工指定模型参数已变得越来越不可行，如何根据训练样本学得最优的模型参数，恰是上述第三个问题。

值得庆幸的是，基于式\eqref{1}的条件独立性，HMM的这三个基本问题均能被高效求解。

